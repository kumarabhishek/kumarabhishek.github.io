{"version":3,"sources":["../../src/components/frequency.js"],"names":["perc2color","$","React","createElement","Frequency","Component","constructor","props","state","value","pos","rail","refSetup","bind","onKeyDown","onMouseDown","onMouseMove","onRailMouseUp","onMouseUp","onTouchStart","calculatePos","calculateValue","val","min","max","step","percent","Math","floor","clientHeight","setState","p","style","backgroundColor","y","diffY","children","getBoundingClientRect","top","e","keyCode","onChange","id","curValue","console","log","preventDefault","document","addEventListener","ismoving","shiftY","clientY","removeEventListener","r","height","rect","ceil","componentDidMount","setTimeout","classList","add","componentWillReceiveProps","newProps","render","class","ref","marginTop"],"mappings":"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","file":"frequency.js","sourcesContent":["/**\n * Frequenct Component: Provide individual frequency selection in an equilizer.\n */\nimport {perc2color} from '../utils/index.js';\n\nconst $ = React.createElement;\n\nexport default class Frequency extends React.Component {\n\tconstructor(props){\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tvalue: props.value,\n\t\t\tpos: 0\n\t\t}\n\t\tthis.rail = null;\n\t\tthis.refSetup = this.refSetup.bind(this);\n\t\tthis.onKeyDown = this.onKeyDown.bind(this);\n\t\tthis.onMouseDown = this.onMouseDown.bind(this);\n\t\tthis.onMouseMove = this.onMouseMove.bind(this);\n\t\tthis.onRailMouseUp = this.onRailMouseUp.bind(this);\n\t\tthis.onMouseUp = this.onMouseUp.bind(this);\n\t\tthis.onTouchStart = this.onTouchStart.bind(this);\n\t\tthis.calculatePos = this.calculatePos.bind(this);\n\t\tthis.calculateValue = this.calculateValue.bind(this);\n\t}\n\n\tcalculatePos(val) {\n\t\tconst { min, max, step} = this.props;\n\t\tconst percent = (( val - min))/(max - min);\n\t\tconst pos = Math.floor(percent*this.rail.clientHeight) - 16;\n\t\tthis.setState({value: val, pos});\n\t\tlet p = (val+max)/(max-min)*100;\n\t\tthis.rail.style.backgroundColor = perc2color(p);\n\t}\n\n\tcalculateValue(y) {\n\t\tconst diffY = y - this.rail.children[0].getBoundingClientRect().top;\n\t\t//\n\t\t//const { min, max, step} = this.props;\n\t\t//const percent = ((max-val))/(max - min);\n\t\t//const pos = Math.floor(percent*this.rail.clientHeight) - 16;\n\t\t//this.setState({value: val, pos});\n\t\tthis.setState({value: val, pos: diffY-16});\n\t}\n\n\tonKeyDown(e){\n\t\t\n\t\tconst { keyCode } = e;\n\t\tconst { min, max, step, onChange, id } = this.props;\n\t\tlet curValue = this.state.value;\n\t\tswitch (keyCode) {\n\t\t\tcase 38:\n\t\t\tcase 39:\n\t\t\t\t//Up/Right Arrow - Decrease frequency\n\t\t\t\tconsole.log('Up', id)\n\t\t\t\te.preventDefault();\n\t\t\t\tcurValue -= step;\n\t\t\t\tcurValue = curValue < min ? min : curValue;\n\t\t\t\tonChange && onChange(id, curValue)\n\t\t\t\tbreak;\n\t\t\tcase 37:\n\t\t\tcase 40:\n\t\t\t\t//Down/Left Arrow - Increase frequency\n\t\t\t\te.preventDefault();\n\t\t\t\tcurValue += step;\n\t\t\t\tcurValue = curValue > max ? max : curValue;\n\t\t\t\tonChange && onChange(id, curValue);\n\t\t\t\tbreak\n\t\t}\n\t}\n\n\tonMouseDown(e) {\n\t\tdocument.addEventListener('mousemove', this.onMouseMove);\n\t\tdocument.addEventListener('mouseup', this.onMouseUp);\n\t\tthis.ismoving = true;\n\t\tthis.shiftY = e.clientY - this.rail.children[0].getBoundingClientRect().top;\n\n\t\tconsole.log('onMouseDown:', e, this.shiftY);\n\t}\n\n\tonMouseUp(e) {\n\t\te.preventDefault();\n\t\tdocument.removeEventListener('mousemove', this.onMouseMove);\n\t\tdocument.removeEventListener('mouseup', this.onMouseUp);\n\t\tthis.ismoving = false;\n\t\t//console.log('onMouseUp:', e);\n\t}\n\n\tonMouseMove(e) {\n\t\te.preventDefault();\n\t\tconst r = this.rail.getBoundingClientRect();\n\t\tlet diffY = e.clientY - r.top;// + this.shiftY;\n\t\tconsole.log(diffY, r.height);\n\t\tif(diffY >= 0 && diffY <= r.height+16){\n\t\t\tconst { min, max, step, id, onChange} = this.props;\n\t\t\tconst percent = (max - min)/100;\n\t\t\tlet val = Math.floor(((max-min) * diffY)/r.height) - max;\n\t\t\tif(val < min) {\n\t\t\t\tval = min;\n\t\t\t} else if(val > max) {\n\t\t\t\tval = max;\n\t\t\t}\n\t\t\tonChange && onChange(id, val);\n\t\t}\n\t\t\n\t}\n\n\tonRailMouseUp(e) {\n\t\te.preventDefault();\n\t\tconst rect = this.rail.getBoundingClientRect();\n\t\tlet diffY = e.clientY - rect.top;\n\t\t\n\t\tif(diffY >= 0 && diffY <= rect.height){\n\t\t\tconst { min, max, step, id, onChange} = this.props;\n\t\t\tlet val = (((max-min) * diffY)/rect.height) - max;\n\t\t\tif(val < 0){\n\t\t\t\tval = Math.floor(val);\n\t\t\t\t\n\t\t\t} else {\n\t\t\t\tval = Math.ceil(val);\n\t\t\t}\n\t\t\t\n\t\t\tif(val < min) {\n\t\t\t\tval = min;\n\t\t\t} else if(val > max) {\n\t\t\t\tval = max;\n\t\t\t}\n\t\t\tonChange && onChange(id, val);\n\t\t}\n\t}\n\n\tonTouchStart(e) {\n\t\t//console.log('onTouchStart', e);\n\t}\n\n\trefSetup(r) {\n\t\tthis.rail = r;\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.calculatePos(this.props.value);\n\t\tsetTimeout(()=> {\n\t\t\tthis.rail.children[0].classList.add('animated');\n\t\t}, 0);\n\t}\n\n\tcomponentWillReceiveProps(newProps) {\n\t\tthis.calculatePos(newProps.value);\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t$('div', {\n\t\t\t\t\tclass:'freq flex justsb flexc', ref: this.refSetup,\n\t\t\t\t\tonMouseUp: this.onRailMouseUp,\n\t\t\t\t\t\n\t\t\t\t}, \n\t\t\t\t$('button', {\n\t\t\t\t\t\tclass: 'knob white',\n\t\t\t\t\t\tstyle: {marginTop: this.state.pos},\n\t\t\t\t\t\tonKeyDown: this.onKeyDown,\n\t\t\t\t\t\tonMouseDown: this.onMouseDown,\n\t\t\t\t\t\t//onMouseUp: this.onMouseUp,\n\t\t\t\t\t\t//onMouseMove: this.onMouseMove,\n\t\t\t\t\t\t//onTouchStart: this.onTouchStart\n\t\t\t\t\t},\n\t\t\t\t\tthis.state.value\n\t\t\t\t),\n\t\t\t)\n\t\t);\n\t}\n};"]}