{"version":3,"sources":["../../src/components/frequency.js"],"names":["perc2color","$","React","createElement","Frequency","Component","constructor","props","state","value","pos","rail","refSetup","bind","onKeyDown","onMouseDown","onMouseMove","onRailMouseUp","onMouseUp","onTouchStart","calculatePos","val","min","max","step","percent","Math","floor","clientHeight","setState","p","style","backgroundColor","e","keyCode","onChange","id","curValue","preventDefault","document","addEventListener","removeEventListener","ismoving","r","getBoundingClientRect","diffY","clientY","top","console","log","height","rect","ceil","componentDidMount","setTimeout","children","classList","add","componentWillReceiveProps","newProps","render","class","ref","marginTop"],"mappings":"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","file":"frequency.js","sourcesContent":["/**\n * Frequenct Component: Provide individual frequency selection in an equilizer.\n */\nimport {perc2color} from '../utils/index.js';\n\nconst $ = React.createElement;\n\nexport default class Frequency extends React.Component {\n\tconstructor(props){\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tvalue: props.value,\n\t\t\tpos: 0\n\t\t}\n\t\tthis.rail = null;\n\t\tthis.refSetup = this.refSetup.bind(this);\n\t\tthis.onKeyDown = this.onKeyDown.bind(this);\n\t\tthis.onMouseDown = this.onMouseDown.bind(this);\n\t\tthis.onMouseMove = this.onMouseMove.bind(this);\n\t\tthis.onRailMouseUp = this.onRailMouseUp.bind(this);\n\t\tthis.onMouseUp = this.onMouseUp.bind(this);\n\t\tthis.onTouchStart = this.onTouchStart.bind(this);\n\t\tthis.calculatePos = this.calculatePos.bind(this);\n\t}\n\n\tcalculatePos(val) {\n\t\tconst { min, max, step} = this.props;\n\t\tconst percent = (( val - min))/(max - min);\n\t\tconst pos = Math.floor(percent*this.rail.clientHeight) - 16;\n\t\tthis.setState({value: val, pos});\n\t\tlet p = (val+max)/(max-min)*100;\n\t\tthis.rail.style.backgroundColor = perc2color(p);\n\t}\n\n\tonKeyDown(e){\n\t\t\n\t\tconst { keyCode } = e;\n\t\tconst { min, max, step, onChange, id } = this.props;\n\t\tlet curValue = this.state.value;\n\t\tswitch (keyCode) {\n\t\t\tcase 38:\n\t\t\tcase 39:\n\t\t\t\t//Up/Right Arrow - Decrease frequency\n\t\t\t\te.preventDefault();\n\t\t\t\tcurValue -= step;\n\t\t\t\tcurValue = curValue < min ? min : curValue;\n\t\t\t\tonChange && onChange(id, curValue)\n\t\t\t\tbreak;\n\t\t\tcase 37:\n\t\t\tcase 40:\n\t\t\t\t//Down/Left Arrow - Increase frequency\n\t\t\t\te.preventDefault();\n\t\t\t\tcurValue += step;\n\t\t\t\tcurValue = curValue > max ? max : curValue;\n\t\t\t\tonChange && onChange(id, curValue);\n\t\t\t\tbreak\n\t\t}\n\t}\n\n\tonMouseDown(e) {\n\t\tdocument.addEventListener('mousemove', this.onMouseMove);\n\t\tdocument.addEventListener('mouseup', this.onMouseUp);\n\t}\n\n\tonMouseUp(e) {\n\t\te.preventDefault();\n\t\tdocument.removeEventListener('mousemove', this.onMouseMove);\n\t\tdocument.removeEventListener('mouseup', this.onMouseUp);\n\t\tthis.ismoving = false;\n\t}\n\n\tonMouseMove(e) {\n\t\te.preventDefault();\n\t\tconst r = this.rail.getBoundingClientRect();\n\t\tlet diffY = e.clientY - r.top;\n\t\tconsole.log(diffY, r.height);\n\t\tif(diffY >= 0 && diffY <= r.height+16){\n\t\t\tconst { min, max, step, id, onChange} = this.props;\n\t\t\tconst percent = (max - min)/100;\n\t\t\tlet val = Math.floor(((max-min) * diffY)/r.height) - max;\n\t\t\tif(val < min) {\n\t\t\t\tval = min;\n\t\t\t} else if(val > max) {\n\t\t\t\tval = max;\n\t\t\t}\n\t\t\tonChange && onChange(id, val);\n\t\t}\n\t\t\n\t}\n\n\tonRailMouseUp(e) {\n\t\te.preventDefault();\n\t\tconst rect = this.rail.getBoundingClientRect();\n\t\tlet diffY = e.clientY - rect.top;\n\t\t\n\t\tif(diffY >= 0 && diffY <= rect.height){\n\t\t\tconst { min, max, step, id, onChange} = this.props;\n\t\t\tlet val = (((max-min) * diffY)/rect.height) - max;\n\t\t\tif(val < 0){\n\t\t\t\tval = Math.floor(val);\n\t\t\t\t\n\t\t\t} else {\n\t\t\t\tval = Math.ceil(val);\n\t\t\t}\n\t\t\t\n\t\t\tif(val < min) {\n\t\t\t\tval = min;\n\t\t\t} else if(val > max) {\n\t\t\t\tval = max;\n\t\t\t}\n\t\t\tonChange && onChange(id, val);\n\t\t}\n\t}\n\n\tonTouchStart(e) {\n\t\t//console.log('onTouchStart', e);\n\t}\n\n\trefSetup(r) {\n\t\tthis.rail = r;\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.calculatePos(this.props.value);\n\t\tsetTimeout(()=> {\n\t\t\tthis.rail.children[0].classList.add('animated');\n\t\t}, 0);\n\t}\n\n\tcomponentWillReceiveProps(newProps) {\n\t\tthis.calculatePos(newProps.value);\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t$('div', {\n\t\t\t\t\tclass:'freq flex justsb flexc', ref: this.refSetup,\n\t\t\t\t\tonMouseUp: this.onRailMouseUp,\n\t\t\t\t\t\n\t\t\t\t}, \n\t\t\t\t$('button', {\n\t\t\t\t\t\tclass: 'knob white',\n\t\t\t\t\t\tstyle: {marginTop: this.state.pos},\n\t\t\t\t\t\tonKeyDown: this.onKeyDown,\n\t\t\t\t\t\tonMouseDown: this.onMouseDown,\n\t\t\t\t\t},\n\t\t\t\t\tthis.state.value\n\t\t\t\t),\n\t\t\t)\n\t\t);\n\t}\n};"]}